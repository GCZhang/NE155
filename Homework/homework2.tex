%--------------------------------------------------------------------
% NE 155 (intro to numerical simulation of radiation transport)
% Homework 2
% Spring 2014

% Exam Template from UMTYMP and Math Department courses
%
% Using Philip Hirschhorn's exam.cls: http://www-math.mit.edu/~psh/#ExamCls
%
% run pdflatex on a finished exam at least three times to do the grading table on front page.

%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% These lines can probably stay unchanged, although you can remove the last
% two packages if you're not making pictures with tikz.
\documentclass[12pts, answers]{exam}
\RequirePackage{amssymb, amsfonts, amsmath, latexsym, verbatim, xspace, setspace}
\RequirePackage{tikz}
\usetikzlibrary {plotmarks}

% By default LaTeX uses large margins.  This doesn't work well on exams; problems
% end up in the "middle" of the page, reducing the amount of space for students
% to work on them.
\usepackage[margin=1in]{geometry}
\usepackage{enumerate}

% Here's where you edit the Class, Exam, Date, etc.
\newcommand{\class}{NE 155}
\newcommand{\term}{Spring 2014}
\newcommand{\assignment}{HW 2}
\newcommand{\duedate}{2/19/14}
%\newcommand{\timelimit}{50 Minutes}

\newcommand{\nth}{n\ensuremath{^{\text{th}}} }
\newcommand{\ve}[1]{\ensuremath{\mathbf{#1}}}
\newcommand{\Macro}{\ensuremath{\Sigma}}
\newcommand{\vOmega}{\ensuremath{\hat{\Omega}}}

% For an exam, single spacing is most appropriate
\singlespacing
% \onehalfspacing
% \doublespacing

% For an exam, we generally want to turn off paragraph indentation
\parindent 0ex

%\unframedsolutions

\begin{document} 

% These commands set up the running header on the top of the exam pages
\pagestyle{head}
\firstpageheader{}{}{}
\runningheader{\class}{\assignment\ - Page \thepage\ of \numpages}{Due \duedate}
\runningheadrule

\begin{flushright}
\begin{tabular}{p{5in} r l}
NE 155 & Spring 2014 \\
Homework \#2 & Due February 19, 2014
\end{tabular}
\end{flushright}
\rule[1ex]{\textwidth}{.1pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% See http://www-math.mit.edu/~psh/#ExamCls for full documentation, but the questions
% below give an idea of how to write questions [with parts] and have the points
% tracked automatically on the cover page.
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Show your work so that partial credit may be awarded.

\begin{questions}

\addpoints
\question[10] 
Determine which of the following matrices are non-singular and compute the inverse of these matrices:
% a values
\newcommand{\aaa}{4}
\newcommand{\aab}{2}
\newcommand{\aac}{6}
\newcommand{\aba}{3}
\newcommand{\abb}{0}
\newcommand{\abc}{7}
\newcommand{\aca}{-2}
\newcommand{\acb}{-1}
\newcommand{\acc}{-3}
% b values
\newcommand{\baa}{2}
\newcommand{\bab}{0}
\newcommand{\bac}{0}
\newcommand{\bba}{0}
\newcommand{\bbb}{-3}
\newcommand{\bbc}{0}
\newcommand{\bca}{0}
\newcommand{\bcb}{0}
\newcommand{\bcc}{1}
% c values
\newcommand{\caa}{1}
\newcommand{\cab}{1}
\newcommand{\cac}{-1}
\newcommand{\cad}{-1}
\newcommand{\cba}{1}
\newcommand{\cbb}{2}
\newcommand{\cbc}{-4}
\newcommand{\cbd}{-2}
\newcommand{\cca}{2}
\newcommand{\ccb}{1}
\newcommand{\ccc}{1}
\newcommand{\ccd}{5}
\newcommand{\cda}{-1}
\newcommand{\cdb}{0}
\newcommand{\cdc}{-2}
\newcommand{\cdd}{-4}
\begin{equation}
\text{a.} \begin{pmatrix}
   \aaa & \aab & \aac \\
   \aba & \abb & \abc \\
   \aca & \acb & \acc \\
\end{pmatrix} \qquad
%
\text{b.} \begin{pmatrix}
   \baa & \bab & \bac \\
   \bba & \bbb & \bbc \\
   \bca & \bcb & \bcc \\
\end{pmatrix} \qquad
%
\text{c.} \begin{pmatrix}
  \caa & \cab & \cac & \cad \\
  \cba & \cbb & \cbc & \cbd \\
  \cca & \ccb & \ccc & \ccd \\
  \cda & \cdb & \cdc & \cdd \\
\end{pmatrix} \nonumber
\end{equation}

%-------------------------------------------------------
%-------------------------------------------------------
\begin{solution}
A way to tell if $\ve{A}$ is singular that we discussed in class is that the determinant of $\ve{A}=0$.

\begin{parts}
\part To find the \ve{a} determinant, use the cofactor method and select $i$ or $j$ = 2 to include the zero entry.
%
\begin{align}
\det(\ve{a})_{j=2} = &\sum_{i=1}^3 a_{i2}(-1)^{i+2}M_{i2} \nonumber \\
%
= &a_{12} (-1)^3 M_{12} + a_{22} (-1)^4 M_{22} + a_{32} (-1)^5 M_{32} \nonumber \\
%
= &-\aab \cdot \det\begin{pmatrix}
   \aba & \abc \\
   \aca & \acc \\ \end{pmatrix} 
+ \abb \cdot \det\begin{pmatrix}
   \aaa & \aac \\
   \aca & \acc \\ \end{pmatrix} \nonumber \\
&- \acb \cdot \det\begin{pmatrix}
   \aaa & \aac \\
   \aba & \abc \\  \end{pmatrix}\nonumber \\
%
= &-\aab [(\aba \cdot \acc) - (\abc \cdot \aca)]% + \abb [(\aaa \cdot \acc) - (\aac \cdot \aca)] 
- \acb [(\aaa \cdot \abc) - (\aac \cdot \aba)] \nonumber \\
%
\det(\ve{a}) = & -2(-9 + 14) + 1(28 - 16) = \boxed{0 \rightarrow \text{singular}} \nonumber
\end{align}

%-------------------------------------------------------
\part Computing the determinant of \ve{b} is easy since it's diagonal:
\begin{align}
\det(\ve{b}) &= \baa ( \bbb \cdot \bcc ) - \bbb ( \baa \cdot \bcc ) + \bcc ( \baa \cdot \bbb ) \nonumber \\
\det(\ve{b}) &= -6 + 6 -6 = \boxed{-6 \rightarrow \text{non-singular}}\nonumber
\end{align}
%
Since \ve{b} is non-singular, we only need to compute it's inverse. Recall that for the inverse of a diagonal matrix $d^{-1}_{ii} = 1/d_{ii}$. Thus,
%
\begin{equation}
\ve{b}^{-1} = \boxed{\begin{pmatrix}
  \frac{1}{2} &  0 & 0 \\
  0 & -\frac{1}{3} & 0 \\
  0 &  0 & 1
\end{pmatrix}} \nonumber
\end{equation}


%-------------------------------------------------------
\part To find the \ve{c} determinant, use the cofactor method and select $i$ = 4 or $j$ = 2 to include the zero entry.
%
\begin{align}
\det(\ve{c})_{j=2} = &\sum_{i=1}^4 c_{i2}(-1)^{i+2}M_{i2} \nonumber \\
%
= &c_{12} (-1)^3 M_{12} + c_{22} (-1)^4 M_{22} + c_{32} (-1)^5 M_{32} + c_{42} (-1)^6 M_{42}\nonumber \\
%
= &-\cab \cdot \det\begin{pmatrix}
  \cba & \cbc & \cbd \\
  \cca & \ccc & \ccd \\
  \cda & \cdc & \cdd \\ \end{pmatrix} 
+ \cbb\cdot \det\begin{pmatrix}
  \caa & \cac & \cad \\
  \cca & \ccc & \ccd \\
  \cda & \cdc & \cdd \\ \end{pmatrix} \nonumber \\
&- \ccb \cdot \det\begin{pmatrix}
  \caa & \cac & \cad \\
  \cba & \cbc & \cbd \\
  \cda & \cdc & \cdd \\ \end{pmatrix}
+ \cdb \cdot \det\begin{pmatrix}
  \caa & \cac & \cad \\
  \cba & \cbc & \cbd \\
  \cca & \ccc & \ccd \\ \end{pmatrix} \nonumber \\
  %
\det(\ve{c}) = &\cdots = \boxed{0 \rightarrow \text{singular}} \nonumber
\end{align}

\end{parts}

\end{solution}



% --------------------------------------------
% ---------------------------------------------
\vspace*{3em}
\addpoints
\question[10] Determine the eigenvalues and associated eigenvectors of the following matrices:
%
% a values
\renewcommand{\aaa}{2}
\renewcommand{\aab}{-1}
\renewcommand{\aba}{-1}
\renewcommand{\abb}{2}
% b values
\renewcommand{\baa}{2}
\renewcommand{\bab}{1}
\renewcommand{\bac}{0}
\renewcommand{\bba}{1}
\renewcommand{\bbb}{2}
\renewcommand{\bbc}{0}
\renewcommand{\bca}{0}
\renewcommand{\bcb}{0}
\renewcommand{\bcc}{3}
% c values
\renewcommand{\caa}{3}
\renewcommand{\cab}{2}
\renewcommand{\cac}{-1}
\renewcommand{\cba}{1}
\renewcommand{\cbb}{-2}
\renewcommand{\cbc}{3}
\renewcommand{\cca}{2}
\renewcommand{\ccb}{0}
\renewcommand{\ccc}{4}
\begin{equation}
\text{a.} \begin{pmatrix}
   \aaa & \aab \\
   \aba & \abb \\
\end{pmatrix} \qquad
%
\text{b.} \begin{pmatrix}
   \baa & \bab & \bac \\
   \bba & \bbb & \bbc \\
   \bca & \bcb & \bcc \\
\end{pmatrix} \qquad
%
\text{c.} \begin{pmatrix}
  \caa & \cab & \cac \\
  \cba & \cbb & \cbc \\
  \cca & \ccb & \ccc \\
\end{pmatrix} \nonumber
\end{equation}

% ---------------------------------------------
\begin{solution}
To find eigenvalues, we need to compute $\det(\ve{A} - \lambda \ve{I})=0$ for each system.

\begin{parts}
\part 
\begin{align}
\det(\ve{a} - \lambda \ve{I}) = &\det\begin{pmatrix}
   \aaa - \lambda & \aab \\
   \aba & \abb - \lambda \\
\end{pmatrix} = 0\nonumber \\
%
= &[(\aaa - \lambda)\cdot(\abb - \lambda) - (\aab \cdot \aba)] \nonumber \\
%
= & \lambda^2 -4 \lambda + 3\nonumber \\
%
= & (\lambda - 3)(\lambda - 1) = 0 \nonumber \\
%
&\boxed{\lambda = 3, 1} \nonumber
\end{align}
 
And the associated right eigenvectors come from $(\ve{a} - \lambda_i \ve{I})\vec{x}_i = \vec{0}$. Use this formula to get the relationship among entries in the eigenvector set the entries. 

E.g., for $\lambda = 3$:
%
\begin{align}
\begin{pmatrix}
   \aaa - 3 & \aab \\
   \aba & \abb - 3 \\
\end{pmatrix} 
\begin{pmatrix} x_1 \\ x_2 \end{pmatrix} &= 
\begin{pmatrix} 0 \\ 0 \end{pmatrix} \nonumber \\
%
-x_1 - x_2 &= 0  \nonumber \\
-x_1 - x_2 &= 0  \nonumber \\
%
\text{Thus } x_1 &= -x_2\:, \qquad \text{Choose }x_1 = 1 \nonumber
\end{align}
This strategy then gives
\begin{equation}
\boxed{\vec{x}_{\lambda =3} = \begin{pmatrix} 1 \\ -1 \end{pmatrix} \qquad
\vec{x}_{\lambda =1} = \begin{pmatrix} 1 \\ 1 \end{pmatrix}} \nonumber
\end{equation}

%------------------------------------
\part 
There are several ways to do this, but we'll again use the cofactors with $j=2$ (like question 1).
\begin{align}
\det(\ve{b} - \lambda \ve{I}) = &\det\begin{pmatrix}
   \baa - \lambda & \bab & \bac \\
   \bba & \bbb - \lambda & \bbc \\
   \bca & \bcb & \bcc - \lambda \\
\end{pmatrix}  = 0\nonumber \\
%
= &-\bab \cdot \det\begin{pmatrix}
   \bba & \bbc \\
   \bca & (\bcc - \lambda) \\ \end{pmatrix} 
+ (\bbb - \lambda) \cdot \det\begin{pmatrix}
   (\baa - \lambda) & \bac \\
   \bca & (\bcc - \lambda) \\ \end{pmatrix} \nonumber \\
&- \bcb \cdot \det\begin{pmatrix}
   (\baa - \lambda) & \bac \\
   \bba & \bbc \\  \end{pmatrix} \nonumber \\
%
= &-\bab [(\bba \cdot (\bcc - \lambda)) - (\bbc \cdot \bca)] + (\bbb - \lambda) [((\baa - \lambda) \cdot (\bcc - \lambda)) - (\bac \cdot \bca)] 
\nonumber \\
%&- \bcb [((\baa - \lambda) \cdot \bbc) - (\bac \cdot \bba)] \nonumber 
%
= & - \lambda^3 + 7 \lambda^2 - 15 \lambda + 9  \nonumber \\
%
= & (\lambda - 3)(\lambda - 3)(-\lambda + 1) = 0 \nonumber \\
%
&\boxed{\lambda = 3, 3, 1} \nonumber
\end{align}
%
And the associated eigenvectors are
%
\begin{equation}
\boxed{\vec{x}_{\lambda =3} = \begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix} \qquad
\vec{x}_{\lambda =3} = \begin{pmatrix} 1 \\ 1 \\ 0 \end{pmatrix}\qquad
\vec{x}_{\lambda =1} = \begin{pmatrix} 1 \\ -1 \\ 0 \end{pmatrix}} \nonumber
\end{equation}

%------------------------------------
\part 
Just like part (b):
\begin{align}
\det(\ve{c} - \lambda \ve{I}) = &\det\begin{pmatrix}
   \caa - \lambda & \cab & \cac \\
   \cba & \cbb - \lambda & \cbc \\
   \cca & \ccb & \ccc - \lambda \\
\end{pmatrix}  = 0\nonumber \\
%
= &-\cab \cdot \det\begin{pmatrix}
   \cba & \cbc \\
   \cca & (\ccc - \lambda) \\ \end{pmatrix} 
+ (\cbb - \lambda) \cdot \det\begin{pmatrix}
   (\caa - \lambda) & \cac \\
   \cca & (\ccc - \lambda) \\ \end{pmatrix} \nonumber \\
&- \ccb \cdot \det\begin{pmatrix}
   (\caa - \lambda) & \cac \\
   \cba & \cbc \\  \end{pmatrix} \nonumber \\
%
= &-\cab [(\cba \cdot (\ccc - \lambda)) - (\cbc \cdot \cca)] + (\cbb - \lambda) [((\caa - \lambda) \cdot (\ccc - \lambda)) - (\cac \cdot \cca)] 
\nonumber \\
%&- \ccb [((\caa - \lambda) \cdot \cbc) - (\cac \cdot \cba)] \nonumber 
%
= & - \lambda^3 + 5 \lambda^2 + 2 \lambda -24  \nonumber \\
%
= & (\lambda - 4)(-\lambda + 3)(\lambda + 2) = 0 \nonumber \\
%
&\boxed{\lambda = 4, 3, -2} \nonumber
\end{align}
%
And the associated eigenvectors are
%
\begin{equation}
\boxed{\vec{x}_{\lambda =4} = \begin{pmatrix} 0 \\ 1 \\ 2 \end{pmatrix} \qquad
\vec{x}_{\lambda =3} = \begin{pmatrix} -1 \\ 1 \\ 2 \end{pmatrix}\qquad
\vec{x}_{\lambda =-2} = \begin{pmatrix} 3 \\ -8 \\ 1 \end{pmatrix}} \nonumber
\end{equation}

\end{parts}

\end{solution}



%------------------------------------
%------------------------------------
\vspace*{3em}
\addpoints
\question[10] We have three systems of linear equations that are similar but different. Of them, \underline{one} has an exact solution, \underline{one} has infinitely many solutions, and \underline{one} has no solution. 
%
\begin{enumerate}[a.]
\item Determine which system is which.
\item Discuss the approach(es) you would use to solve these systems by hand.
\item Find the solutions (as applicable). You may use MATLAB or Python to solve these systems. 
\end{enumerate}
%
\begin{enumerate}
\item 
\begin{align}
4 x_1 -   x_2 + 2 x_3 + 3 x_4 &= 20 \nonumber \\
      - 2 x_2 + 7 x_3 - 4 x_4 &= -7 \nonumber \\
                6 x_3 + 5 x_4 &= 4  \nonumber \\
                        3 x_4 &= 6  \nonumber
\end{align}

\item 
\begin{align}
4 x_1 -   x_2 + 2 x_3 + 3 x_4 &= 20 \nonumber \\
        0 x_2 + 7 x_3 - 4 x_4 &= -7 \nonumber \\
                6 x_3 + 5 x_4 &= 4  \nonumber \\
                        3 x_4 &= 6  \nonumber
\end{align}

\item 
\begin{align}
4 x_1 -   x_2 + 2 x_3 + 3 x_4 &= 20 \nonumber \\
        0 x_2 + 7 x_3 + 0 x_4 &= -7 \nonumber \\
                6 x_3 + 5 x_4 &= 4  \nonumber \\
                        3 x_4 &= 6  \nonumber
\end{align}
\end{enumerate}

\begin{solution}
\begin{parts}
\part 
To determine which system is which, write the equations in matrix form and row-reduce. If the condition $a_{ii} \neq 0$ is not met $\forall i$, then the system has either no solution or infinitely many solutions. This can also be checked by seeing if the determinant is non-zero.

If, after row-reduction, $a_{ii} =  0$ for some $i$ (or the determinant is zero), then the system has infinitely many solutions if a free-variable can be established or no solution if one cannot.

Using this information:
%
\begin{enumerate}
\item The first system has \textbf{a unique solution} because, when expressed in echelon form, there is one unknown for each equation.

\item The second system \textbf{does not have a solution}; the determinant of its matrix is zero but reduction to echelon form does not yield any free variables.

\item The third system has \textbf{infinitely many} solutions; the determinant of its matrix is zero and reduction to echelon form does yield a free variable. 
\end{enumerate}

\part 
\begin{itemize}
\item To solve the system with a unique solution, use backward substitution.
\item To solve the system with infinitely many solutions, use backward substitution and express the results as a relationship between $\vec{x}$ entries.
\end{itemize}

\part 
Using Python's numPy linearalgebra solve function, the solution for the first system is
%
\begin{equation}
\boxed{x = \begin{pmatrix}3 \\ -4 \\ -1 \\ 2\end{pmatrix}} \nonumber
\end{equation}

For finding infinitely many solutions:
%
% c values
\renewcommand{\caa}{4}
\renewcommand{\cab}{-1}
\renewcommand{\cac}{2}
\renewcommand{\cad}{3}
\renewcommand{\cba}{0}
\renewcommand{\cbb}{0}
\renewcommand{\cbc}{7}
\renewcommand{\cbd}{0}
\renewcommand{\cca}{0}
\renewcommand{\ccb}{0}
\renewcommand{\ccc}{6}
\renewcommand{\ccd}{5}
\renewcommand{\cda}{0}
\renewcommand{\cdb}{0}
\renewcommand{\cdc}{0}
\renewcommand{\cdd}{3}
\newcommand{\ba}{20}
\newcommand{\bb}{-7}
\newcommand{\bc}{4}
\newcommand{\bd}{6}
%
\begin{align}
\begin{pmatrix}
  \caa & \cab & \cac & \cad \\
  \cba & \cbb & \cbc & \cbd \\
  \cca & \ccb & \ccc & \ccd \\
  \cda & \cdb & \cdc & \cdd \\
\end{pmatrix} 
\begin{pmatrix} x_1 \\ x_2 \\ x_3 \\ x_4 \end{pmatrix} &= 
\begin{pmatrix} \ba \\ \bb  \\ \bc \\ \bd \end{pmatrix} \nonumber \\
%
\cdd x_4 &= \bd \rightarrow \boxed{x_4 = 2} \nonumber \\
%
\ccc x_3 + \ccd x_4 &= \bc \rightarrow \boxed{x_3 = -1} \nonumber \\
%
\text{The 2nd row equation confirms } &x_3 = -1 \nonumber \\
%
\caa x_1 + \cab x_2 + \cac x_3 + \cad x_4 &= \ba \rightarrow \boxed{x_2 = x_1 - 4} \nonumber
\end{align}
%
Using this information we can select $x_1$ and determine a solution for the system. 
\end{parts}
\end{solution}



% ---------------------------------------------
% ---------------------------------------------
\vspace*{3em}
\addpoints
\question[10] Find the parabola
\[ y = a + bx + cx^2\]
that passes through the points $(1,1)$, $(2,-1)$, and $(3,1)$. 

Use Gaussian elimination and backward substitution as your solution technique.

\begin{solution}
We have three points and three unknowns in $y = a + bx + cx^2$. We can therefore create system of equations to create a matrix problem:
%
\newcommand{\pxa}{1}
\newcommand{\pya}{1}
\newcommand{\pxb}{2}
\newcommand{\pyb}{-1}
\newcommand{\pxc}{3}
\newcommand{\pyc}{1}
\begin{align}
(\pxa,\pya): &\qquad a + b(\pxa) + c(\pxa^2) = \pya \nonumber \\
%
(\pxb,\pyb): &\qquad a + b(\pxb) + c(\pxb^2) = \pyb \nonumber \\
%
(\pxc,\pyc): &\qquad a + b(\pxc) + c(\pxc^2) = \pyc \nonumber \\
%
\text{This all gives } &\begin{pmatrix}
1 & \pxa & \pxa^2 \\
1 & \pxb & \pxb^2 \\
1 & \pxc & \pxc^2 \\
\end{pmatrix}
\begin{pmatrix} a \\ b \\ c \end{pmatrix} =
\begin{pmatrix} \pya \\ \pyb \\ \pyc \end{pmatrix} \nonumber
\end{align}
%
Use Gaussian elimination to get this matrix into echelon form:
\begin{align}
\begin{pmatrix}
1 & \pxa & 1 \\
0 & 1 & 3 \\
0 & 2 & 8 \\
\end{pmatrix}
\begin{pmatrix} a \\ b \\ c \end{pmatrix} &=
\begin{pmatrix} \pya \\ -2 \\ 0 \end{pmatrix} \qquad \text{R2 - R1; R3 - R1}\nonumber \\
%
\begin{pmatrix}
1 & \pxa & 1 \\
0 & 1 & 3 \\
0 & 0 & 2 \\
\end{pmatrix}
\begin{pmatrix} a \\ b \\ c \end{pmatrix} &=
\begin{pmatrix} \pya \\ -2 \\ 4 \end{pmatrix} \qquad \text{R3 - 2R1}\nonumber
\end{align}
%
Using backward substitution, we can see
%
\begin{align}
c &= 4/2 = 2 \nonumber \\
b &= -2 - 3(2) \nonumber \\
a &= 1 +8 -2 = 7 \nonumber
\end{align}

Thus, the equation for the parabola is
\begin{equation}
\boxed{y = 7 - 8x + 2 x^2} \:. \nonumber
\end{equation}
\end{solution}


% ---------------------------------------------
% ---------------------------------------------
\vspace*{3em}
\addpoints
\question[10] Determine the spectral radii of the following matrices:
%
% a values
\renewcommand{\aaa}{0}
\renewcommand{\aab}{1/2}
\renewcommand{\aba}{1/2}
\renewcommand{\abb}{0}
% b values
\renewcommand{\baa}{-1}
\renewcommand{\bab}{2}
\renewcommand{\bac}{0}
\renewcommand{\bba}{0}
\renewcommand{\bbb}{3}
\renewcommand{\bbc}{4}
\renewcommand{\bca}{0}
\renewcommand{\bcb}{0}
\renewcommand{\bcc}{7}
%
\begin{equation}
\text{a.} \begin{pmatrix}
   \aaa & \aab \\
   \aba & \abb \\
\end{pmatrix} \qquad
%
\text{b.} \begin{pmatrix}
   \baa & \bab & \bac \\
   \bba & \bbb & \bbc \\
   \bca & \bcb & \bcc \\
\end{pmatrix} \nonumber
\end{equation}
%
Discuss the significance of the spectral radius for the iterative solution of $\ve{A}\vec{x} = \vec{b}$.

\begin{solution}
To find the spectral radius we need to find the (absolute value) largest of the eigenvalues, so we need to compute $\det(\ve{A} - \lambda \ve{I})=0$ for each system.

\begin{parts}
\part 
\begin{align}
\det(\ve{a} - \lambda \ve{I}) = &\det\begin{pmatrix}
   \aaa - \lambda & \aab \\
   \aba & \abb - \lambda \\
\end{pmatrix} = 0\nonumber \\
%
= &[(\aaa - \lambda)\cdot(\abb - \lambda) - (\aab \cdot \aba)] \nonumber \\
%
= & \lambda^2 - \frac{1}{4}\nonumber \\
%
= & (\lambda - \frac{1}{2})(\lambda +  \frac{1}{2}) = 0 \nonumber \\
%
&\boxed{\rho(\ve{A}) = \frac{1}{2}} \nonumber
\end{align}
 
%------------------------------------
\part 
There are several ways to do this, but we'll use the cofactors with $j=1$ since that column has two zeros.
%
\begin{align}
\det(\ve{b} - \lambda \ve{I}) = &\det\begin{pmatrix}
   \baa - \lambda & \bab & \bac \\
   \bba & \bbb - \lambda & \bbc \\
   \bca & \bcb & \bcc - \lambda \\
\end{pmatrix}  = 0\nonumber \\
%
= &-(\baa - \lambda) \cdot \det \begin{pmatrix}
   (\bbb - \lambda) & \bbc \\
   \bcb & (\bcc - \lambda) \\ \end{pmatrix} 
+ 0 + 0\nonumber \\
%
= & -(\baa - \lambda)[(\bbb - \lambda)(\bcc - \lambda) - \bbc \cdot  \bcb] \nonumber \\
%
= & (-\lambda - 1)(\lambda - 3)(\lambda - 7) = 0 \nonumber \\
%
&\boxed{\rho(\ve{b}) = 7} \nonumber
\end{align}
%
\end{parts}

The spectral radius of a matrix $\ve{A}$ will affect if and how fast the iterative solution converges. If we define $\ve{P} = \ve{Q}^{-1}(\ve{Q}-\ve{A})$ as in class, then the spectral radius of \ve{P}, $\rho(\ve{P})$, determines the convergence of the iterative method to the true solution. 

If $\rho(\ve{P}) > 1$, the method will not converge. If $\rho(\ve{P}) < 1$, the method will converge. The magnitude of $\rho(\ve{P})$ will dictate how fast convergence/divergence happens. 

It is important to note the if $\rho(\ve{A})$ is always $<$ 1, the solution will go to 0 as iteration index $k \rightarrow \infty$, which we do not want. We want the error to go to zero, which matrix \ve{P} reflects, so \ve{P}'s spectral radius should be less than 1.

\end{solution}


% ---------------------------------------------
% ---------------------------------------------
\vspace*{3em}
\addpoints
\question[10] Find the LU Decomposition of $\ve{A}$ using Gaussian elimination and use it to solve $\ve{A}\vec{x} = \vec{b}$.
%
% b values
\renewcommand{\baa}{10}
\renewcommand{\bab}{-7}
\renewcommand{\bac}{0}
\renewcommand{\bba}{-3}
\renewcommand{\bbb}{2}
\renewcommand{\bbc}{6}
\renewcommand{\bca}{5}
\renewcommand{\bcb}{-1}
\renewcommand{\bcc}{5}
% soln vector
\newcommand{\ba}{7}
\newcommand{\bb}{4}
\newcommand{\bc}{6}
%
\begin{equation}
\ve{A} = \begin{pmatrix}
   \baa & \bab & \bac \\
   \bba & \bbb & \bbc \\
   \bca & \bcb & \bcc \\
\end{pmatrix} \; \qquad
%
\vec{b} = \begin{pmatrix} \ba \\ \bb \\ \bc \end{pmatrix} \nonumber
\end{equation}

\begin{solution}
Create $\ve{U}$ by row-reducing $\ve{A}$:
%
\begin{equation}
\begin{pmatrix}
   \baa & \bab & \bac \\
   0    & -1/10 & \bbc \\
   0    & 2.5 & \bcc \\
\end{pmatrix} \qquad \begin{pmatrix}
 & \\ R_2 - m_{21}R_1, & m_{21} = (\bba / \baa) \\ 
      R_3 - m_{31}R_1, & m_{31} = (\bca / \baa) \end{pmatrix} \nonumber 
\end{equation}
%
Since the second pivot entry, -0.1, is much smaller than the other entries we will exchange (or pivot) the second and third rows. This requires that we create a pivot matrix to keep track of this:
\[\ve{P} = \begin{pmatrix}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0
\end{pmatrix}\]
Then we continue row-reducing \ve{U}.
%
\begin{align}
\ve{U} &= \begin{pmatrix}
   \baa & \bab & \bac \\
   0    & 2.5 & \bcc \\
   0    & -0.1 & \bbc \\
\end{pmatrix} \:; 
\qquad \vec{b} = \begin{pmatrix} \ba \\ \bc \\ \bb \end{pmatrix} \nonumber \\
%
&= \begin{pmatrix}
   \baa & \bab & \bac \\
   0    & 2.5  & \bcc \\
   0    & 0    & 6.2 \\
\end{pmatrix} 
\qquad
\begin{pmatrix} & \\ & \\ R_3 - m_{32}R_2, & m_{32} = (-0.1 / 2.5) \end{pmatrix} \nonumber 
\end{align}

We now have all of the parts to write out the LU decomposition, formulated as $\ve{P}\ve{A} = \ve{L}\ve{U}$:
\begin{equation}
\boxed{\begin{pmatrix}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0
\end{pmatrix} % P
\begin{pmatrix}
   \baa & \bab & \bac \\
   \bba & \bbb & \bbc \\
   \bca & \bcb & \bcc \\
\end{pmatrix} = % A
%
\begin{pmatrix}
1 & 0 & 0 \\
0.5 & 1 & 0 \\
-0.3 & -0.04 & 1 \\
\end{pmatrix} % L
\begin{pmatrix}
   \baa & \bab & \bac \\
   0    & 2.5  & \bcc \\
   0    & 0    & 6.2 \\
\end{pmatrix} \nonumber} % U
\end{equation}
%
To solve $\ve{A}\vec{x} = \vec{b}$ with this system, we 
%
\begin{enumerate}
\item Solve $\ve{L}\vec{y} = \vec{b}$ for $\vec{y}$ using forward substitution
\item Solve $\ve{U}\vec{x} = \vec{y}$ for $\vec{x}$ using backward substitution
\end{enumerate}
%
And this gives
\begin{equation}
\boxed{\vec{x}= \begin{pmatrix} 0 \\ -1 \\ 1 \end{pmatrix}} \nonumber
\end{equation}

\textit{Note:} a faster way to get $\vec{x}$ if you're just solving this system once is to reduce $\vec{b}$ in the same way you reduce \ve{U} (we'll call this $\tilde{\vec{b}}$), and then solve $\ve{U}\vec{x} = \tilde{\vec{b}}$ using backward substitution.

\end{solution}

\end{questions}

\end{document}
